---
title: "Redes Especificas"
output: html_document
date: '2022-09-06'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo=FALSE)
```

```{r}
library(tidyverse)
library(tidygraph)
library(ggraph)
library(igraphdata)
library(grid)
```

```{r, echo=TRUE}
set_graph_style(
  family = "sans",
  title_size = 12,
  title_face = "bold"
)

palette_cargo <- c("brown","blue1","green4")

palette_edo32 <- c("#FC0D26","#00FFA3","#2A26F7","#F9CCCE","#FC0DDF","#00CEFA","#FD901C","#16803D",
                   "#EEE500","#B52660","#5D357D","#D078FF","#22FBE0","#874B0D","#F48DDA","#6C949C",
                   "#ADF57E","#ADA75D","#7299FB","#D1C2FF","#F40077","#D13D26","#B7EEC4","#8A4965",
                   "#16FB0D","#FDC25F","#FE9794","#FB26AF","#AF00AA","#4F493B","#2271A3","#5C22B0")  

palette_escuela <- c("dodgerblue2","#E31A1C","green4","#6A3D9A","blue1",
                     "palegreen2","#FB9A99","skyblue2","deeppink1","#FF7F00",
                     "#CAB2D6","#FDBF6F", "gray70","khaki2","maroon",
                     "orchid1","gold1","steelblue4","darkturquoise",
                     "green1","yellow4","black","yellow3","darkorange4","brown")  

draw_key_custom = function(data, params, size) {
  segmentsGrob(0.1, 0.5, 0.9, 0.5,
               gp = gpar(
                 col = alpha(data$edge_colour, data$edge_alpha),
                 fill = alpha(data$edge_colour, data$edge_alpha),
                 lwd = data$edge_width * .pt,
                 lty = data$edge_linetype, lineend = 'butt'
               ),
               arrow = params$arrow
  )
}
```

# Análisis de redes específicas:

Sub-red ponente-secretario por instancia, pintando por materia única:

```{r} 
#
subred_pon_sec_tribunales %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Tribunales Colegiados de Circuito') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())


subred_pon_sec_pleno %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Pleno') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala1 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 1a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala2 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 2a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala3 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 3a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala4 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 4a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_salaaux %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen + 4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Sala Auxiliar') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-secretario por instancia, pintando por escuela:

```{r} 
subred_pon_sec_tribunales %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Tribunales Colegiados de Circuito') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_pleno %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Pleno') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 1a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 2a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala3 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 3a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala4 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 4a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_salaaux %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Sala Auxiliar') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-secretario por instancia, pintando por estado:

```{r} 

subred_pon_sec_tribunales %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Tribunales Colegiados de Circuito') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_pleno %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Pleno') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 1a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 2a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala3 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") + 
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 3a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_sala4 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: 4a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_salaaux %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen + 4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Sala Auxiliar') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-ponente por instancia, pintando por materia única:

```{r} 
subred_pon_pon_tribunales %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Tribunales Colegiados de Circuito') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_pleno %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Pleno') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala1 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 1a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala2 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 2a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala3 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 3a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala4 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 4a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_salaaux %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Sala Auxiliar') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-ponente por instancia, pintando por escuela:

```{r} 

subred_pon_pon_tribunales %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Tribunales Colegiados de Circuito') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_pleno %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Pleno') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 1a Sala') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 2a Sala') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala3 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 3a Sala') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala4 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 4a Sala') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_salaaux %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Sala Auxiliar') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-ponente por instancia, pintando por estado:

```{r} 
subred_pon_pon_tribunales %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Tribunales Colegiados de Circuito') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_pleno %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Pleno') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 1a Sala') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 2a Sala') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala3 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 3a Sala') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_sala4 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: 4a Sala') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_salaaux %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Sala Auxiliar') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red 1er Criterio por instancia, pintando por materia única:

```{r} 

subred_1a_reit_tribunales %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Tribunales Colegiados de Circuito') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_pleno %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") + 
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Pleno') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala1 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 1a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala2 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 2a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala3 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 3a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala4 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 4a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_salaaux %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Sala Auxiliar') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red 1er Criterio por instancia, pintando por escuela:

```{r} 
subred_1a_reit_tribunales %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Tribunales Colegiados de Circuito') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_pleno %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Pleno') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 1a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 2a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala3 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 3a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala4 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 4a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_salaaux %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Sala Auxiliar') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red 1er Criterio por instancia, pintando por estado:

```{r} 
subred_1a_reit_tribunales %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Tribunales Colegiados de Circuito') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_pleno %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Pleno') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 1a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 2a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala3 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 3a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_sala4 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 4a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_salaaux %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Sala Auxiliar') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-secretario por materia, pintando por escuela:

```{r} 
subred_pon_sec_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Administrativa')  +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Civil') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Común') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Constitucional') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Laboral') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.00000000000000005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Penal') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Penal') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-secretario por materia, pintando por estado:

```{r} 
subred_pon_sec_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Administrativa') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())


subred_pon_sec_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Civil') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Común') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Constitucional') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Laboral') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Penal') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-secretario por materia, pintando por instancia:

```{r} 
subred_pon_sec_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Administrativa') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Civil') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Común') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Constitucional') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Laboral') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_sec_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Secretario: Materia Penal') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-ponente por materia, pintando por escuela:

```{r} 
subred_pon_pon_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Administrativa') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Civil') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) +  
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Común') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Constitucional') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Laboral') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Penal') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-ponente por materia, pintando por estado:

```{r} 
subred_pon_pon_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Administrativa') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Civil') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Común') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Constitucional') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Laboral') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Penal') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red ponente-ponente por materia, pintando por instancia:

```{r} 
subred_pon_pon_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Administrativa') +
  labs(size="Centralidad", edge_color="Instancia") + 
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Civil') +
  labs(size="Centralidad", edge_color="Instancia") + 
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Común') +
  labs(size="Centralidad", edge_color="Instancia") + 
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Constitucional') +
  labs(size="Centralidad", edge_color="Instancia") + 
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Laboral') +
  labs(size="Centralidad", edge_color="Instancia") + 
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_pon_pon_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Ponente-Ponente: Materia Penal') +
  labs(size="Centralidad", edge_color="Instancia") + 
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red 1er Criterio por materia, pintando por escuela:

```{r} 
subred_1a_reit_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Administrativa') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Civil') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Común') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Constitucional') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Laboral') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Penal') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red 1er Criterio por materia, pintando por estado:

```{r} 
subred_1a_reit_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Administrativa') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Civil') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Común') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Constitucional') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Laboral') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) +
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Penal') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Sub-red 1er Criterio por materia, pintando por instancia:

```{r} 
subred_1a_reit_admin %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Administrativa') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_civil %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Civil') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_comun %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Común') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Constitucional') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_laboral %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Laboral') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

subred_1a_reit_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  ggraph(layout = 'kk') +
  geom_edge_fan(aes(color=instancia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: Materia Penal') +
  labs(colour="Cargo", size="Centralidad", edge_color="Instancia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

Ordenando las redes por centralidad:

```{r, echo=TRUE}
# Red ponente-ponente:
red_pon_pon %>% 
    activate(nodes) %>% 
    as_tibble() %>% 
    arrange(desc(central_eigen))
```

```{r, echo=TRUE}
# Red ponente-secretario:
red_pon_sec %>% 
    activate(nodes) %>% 
    as_tibble() %>% 
    arrange(desc(central_eigen))
```

```{r, echo=TRUE}
# Red primera reiteración:
red_1a_reit %>% 
    activate(nodes) %>% 
    as_tibble() %>% 
    arrange(desc(central_eigen))
```

#-------------------------------------------------------------

Redes para revisión 09/09/22:

```{r}
#Creamos layouts para poder editar parámetros
set.seed(2022)

layout_1ercrit_sala1 <- subred_1a_reit_sala1 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  create_layout(., layout = 'kk')

layout_1ercrit_sala2 <- subred_1a_reit_sala2 %>%
  activate(edges) %>%
  filter(!grepl(".*,.*", materia)) %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  create_layout(., layout = 'kk')

layout_ponsec_sala1 <- subred_pon_sec_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  create_layout(., layout = 'kk')

layout_ponsec_sala2 <- subred_pon_sec_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  create_layout(., layout = 'kk')

layout_ponpon_sala1 <- subred_pon_pon_sala1 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  create_layout(., layout = 'kk')

layout_ponpon_sala2 <- subred_pon_pon_sala2 %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.05) %>%
  create_layout(., layout = 'kk')

layout_ponsec_const <- subred_pon_sec_const %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  create_layout(., layout = 'kk')

layout_ponsec_penal <- subred_pon_sec_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.005) %>%
  create_layout(., layout = 'kk')

layout_ponsec_penal_masnodos <- subred_pon_sec_penal %>%
  activate(nodes) %>% 
  filter(central_eigen >= 0.00000000000000005) %>%
  create_layout(., layout = 'kk')

layout_1ercrit_sala1$x[layout_1ercrit_sala1$label == "PRJ_3299"] <- 2
```

```{r}
ggraph(layout_1ercrit_sala1) + 
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 1a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_1ercrit_sala2) +
  geom_edge_fan(aes(color=materia, end_cap=circle(node2.central_eigen+4,"pt")), arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, color=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red 1er Criterio: 2a Sala') +
  labs(colour="Cargo", size="Centralidad", edge_color="Materia") + 
  scale_color_manual(values = palette_cargo) +
  scale_edge_color_brewer(palette = 'Set2') + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_sala1) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Sec, 1a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_sala2) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) +  
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Sec, 2a Sala') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_sala1) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Sec, 1a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_sala2) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Sec, 2a Sala') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponpon_sala1) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Pon, 1a Sala') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponpon_sala2) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Pon, 2a Sala') +
  labs(colour="Escuela", size="Centralidad") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponpon_sala1) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Pon, 1a Sala') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponpon_sala2) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo))) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red Pon-Pon, 2a Sala') +
  labs(colour="Estado", size="Centralidad") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())
```

```{r}
ggraph(layout_ponsec_const) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Constitucional') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_const) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Constitucional') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_penal) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Penal') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_penal_masnodos) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Penal') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.3, 'cm'), 
        legend.key.height = unit(0.3, 'cm'), 
        legend.key.width = unit(0.3, 'cm'), 
        legend.title = element_text(size=6), 
        legend.text = element_text(size=5),
        panel.border = element_blank()) 

ggraph(layout_ponsec_penal) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Penal') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.4, 'cm'), 
        legend.key.height = unit(0.4, 'cm'), 
        legend.key.width = unit(0.4, 'cm'), 
        legend.title = element_text(size=7), 
        legend.text = element_text(size=6),
        panel.border = element_blank())

ggraph(layout_ponsec_penal_masnodos) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Penal') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.3, 'cm'), 
        legend.key.height = unit(0.3, 'cm'), 
        legend.key.width = unit(0.3, 'cm'), 
        legend.title = element_text(size=6), 
        legend.text = element_text(size=5),
        panel.border = element_blank()) 
```

```{r, fig.width=4, fig.height=3}
ggraph(layout_ponsec_penal_masnodos) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(escuela), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Penal') +
  labs(colour="Escuela", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_escuela) + 
  theme(legend.key.size = unit(0.2, 'cm'), 
        legend.key.height = unit(0.2, 'cm'), 
        legend.key.width = unit(0.2, 'cm'), 
        legend.title = element_text(size=5), 
        legend.text = element_text(size=4),
        panel.border = element_blank()) 

ggraph(layout_ponsec_penal_masnodos) +
  geom_edge_fan(aes(end_cap=circle(node2.central_eigen+4,"pt")), colour="gray", arrow=arrow(angle=15,length=unit(2,"mm"),ends="last",type="closed"),key_glyph="custom") +
  geom_node_point(aes(size=central_eigen, colour=factor(edo), shape=cargo)) + 
  geom_node_text(aes(label=label), repel=T, size=2, nudge_y = 0.1, nudge_x = -0.1) +
  ggtitle('Sub-red pon-sec, Materia Penal') +
  labs(colour="Estado", size="Centralidad", shape="Cargo") + 
  scale_color_manual(values = palette_edo32) + 
  theme(legend.key.size = unit(0.3, 'cm'), 
        legend.key.height = unit(0.3, 'cm'), 
        legend.key.width = unit(0.3, 'cm'), 
        legend.title = element_text(size=6), 
        legend.text = element_text(size=5),
        panel.border = element_blank()) 
```
